---
title: "Defense"
editor: visual
execute: 
  echo: false
---

```{r}
#| echo: false
#| message: false
#| warning: false
library(tidyverse)
library(readxl)
library(writexl)
library(stringr)
library(rstanarm)
library(dplyr)
library(ggplot2)
library(plotly)
```

```{r}
#| echo: false
#| message: false
#| warning: false
data <- read.csv("mls-salaries-2007.csv")

```


### Plot for all defenders in MLS League in 2007


```{r}

#| echo: false
#| message: false
#| warning: false

data |> 
  filter(position == "D") |> 
  select(position, base_salary, club, first_name, last_name) |>
  ggplot(mapping = aes(x = position, 
                       y = base_salary, 
                       color = club)) + 
  geom_jitter() + 
  scale_y_continuous(labels=scales::dollar_format()) + 
  labs(title = "Soccer salaries earned for defensive players in 2007", 
       x = "Position", 
       y = "Player Base Salary", 
       caption = "Source: Originally from MLS Union", 
       color = "Club") + 
  theme_classic() + 
  geom_hline(yintercept = 66842.51, linetype = "dashed", color = "red")  



```






This data shows the spread of salaries for defenders in 2007. The colors show the clubs each player was in, and the spread is wider than some might think. The line in the middle of the graph displays the average for all defenders in the MLS League in 2007, which is $66,842.51.
